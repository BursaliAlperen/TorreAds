<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>TorreAds</title>
    
    <!-- GigaPub SDK -->
    <script src="https://ad.gigapub.tech/script?id=986"></script>

    <!-- Telegram Web App Script -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <style>
        /* CSS Code - Beyaz Mavi Tema */
        :root {
            --tg-theme-bg-color: #f5f9ff; --tg-theme-text-color: #1a365d; --tg-theme-button-color: #2c7be5;
            --tg-theme-button-text-color: #ffffff; --tg-theme-hint-color: #5a7ba7; --success-color: #00d97e;
            --warning-color: #f6c343; --danger-color: #e63757; --secondary-bg-color: #ffffff; --border-color: #d1e3ff;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; margin: 0;
            padding: 20px 15px 90px 15px; background-color: var(--tg-theme-bg-color); color: var(--tg-theme-text-color);
            display: flex; flex-direction: column; align-items: center; text-align: center; min-height: 100vh; box-sizing: border-box;
        }
        .container { width: 100%; max-width: 500px; }
        .view { display: none; width: 100%; animation: fadeIn 0.3s ease-in-out; }
        #home-view { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .header { margin-bottom: 25px; }
        .header h1 { font-size: 32px; font-weight: 700; margin-bottom: 5px; color: #1a365d; }
        .header p { color: var(--tg-theme-hint-color); font-size: 16px; }
        .card {
            background-color: var(--secondary-bg-color); padding: 25px; border-radius: 16px; margin-bottom: 25px;
            box-shadow: 0 8px 16px rgba(0, 123, 255, 0.1); border: 1px solid var(--border-color);
        }
        .card h2 {
            margin: 0 0 12px 0; font-size: 16px; color: var(--tg-theme-hint-color); font-weight: 500;
            text-transform: uppercase; letter-spacing: 0.5px;
        }
        .balance-amount { font-size: 42px; font-weight: 700; color: #1a365d; margin-bottom: 10px; }
        .ad-info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; text-align: center; }
        .ad-info-item h3 { font-size: 20px; font-weight: 600; margin: 0 0 5px 0; color: #1a365d; }
        .ad-info-item p { font-size: 14px; color: var(--tg-theme-hint-color); margin: 0; }
        .ad-buttons { display: flex; flex-direction: column; gap: 15px; margin-bottom: 25px; }
        .btn {
            width: 100%; padding: 16px; font-size: 18px; font-weight: 600; border: none; border-radius: 12px; cursor: pointer;
            transition: transform 0.2s ease, background-color 0.2s ease, box-shadow 0.2s ease;
            background: linear-gradient(145deg, var(--tg-theme-button-color), #1a6fd9); color: var(--tg-theme-button-text-color);
            box-shadow: 0 4px 10px rgba(44, 123, 229, 0.2);
        }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 6px 15px rgba(44, 123, 229, 0.3); }
        .btn:active { transform: scale(0.98); }
        .btn:disabled { background: #c5d9ff; color: #8ba7d0; cursor: not-allowed; box-shadow: none; transform: none; }
        #mainWithdrawBtn { background: linear-gradient(145deg, var(--success-color), #00b86c); box-shadow: 0 4px 10px rgba(0, 217, 126, 0.2); }
        #mainWithdrawBtn:disabled { background: #c5d9ff; box-shadow: none; }
        .status-message {
            position: fixed; bottom: 80px; left: 50%; transform: translateX(-50%); width: 90%; max-width: 480px;
            padding: 12px 15px; border-radius: 10px; font-weight: 500; display: none; animation: fadeIn 0.3s;
            z-index: 1000; box-sizing: border-box;
        }
        .success { display: block; background-color: rgba(0, 217, 126, 0.15); border-left: 5px solid var(--success-color); color: #008a50; }
        .error { display: block; background-color: rgba(230, 55, 87, 0.15); border-left: 5px solid var(--danger-color); color: #c41a3a; }
        .info { display: block; background-color: rgba(44, 123, 229, 0.15); border-left: 5px solid var(--tg-theme-button-color); color: #1a6fd9; }
        .footer-nav {
            position: fixed; bottom: 0; left: 0; right: 0; background-color: var(--secondary-bg-color); display: flex;
            justify-content: space-around; padding: 10px 0; box-shadow: 0 -4px 12px rgba(0, 123, 255, 0.1);
            border-top: 1px solid var(--border-color); z-index: 999;
        }
        .nav-btn {
            background: none; border: none; color: var(--tg-theme-hint-color); display: flex; flex-direction: column;
            align-items: center; font-size: 12px; font-weight: 500; cursor: pointer; padding: 5px 15px;
            border-radius: 12px; transition: color 0.2s, background-color 0.2s;
        }
        .nav-btn.active { color: var(--tg-theme-button-color); }
        .nav-btn:hover:not(.active) { color: #1a365d; }
        .nav-btn .icon { width: 28px; height: 28px; margin-bottom: 4px; }
        .input-group { margin-bottom: 20px; text-align: left; }
        .input-group label { display: block; margin-bottom: 8px; color: var(--tg-theme-hint-color); font-size: 14px; font-weight: 500; }
        .input-group input, .input-group textarea {
            width: 100%; padding: 14px; border-radius: 10px; border: 1px solid var(--border-color);
            background-color: #f5f9ff; color: var(--tg-theme-text-color); font-size: 16px; box-sizing: border-box;
        }
        .input-group input:focus, .input-group textarea:focus { outline: none; border-color: var(--tg-theme-button-color); box-shadow: 0 0 0 3px rgba(44, 123, 229, 0.2); }
        #referralLink {
            background-color: #f0f7ff; padding: 15px; border-radius: 10px; word-wrap: break-word;
            border: 1px dashed var(--tg-theme-hint-color); margin-top: 15px; cursor: pointer; color: #1a365d;
            transition: background-color 0.2s; text-align: left;
        }
        #referralLink:hover { background-color: #e1efff; }
        .admin-panel {
            display: none; margin-top: 30px; padding: 15px; border: 1px solid var(--warning-color);
            border-radius: 10px; background-color: rgba(246, 195, 67, 0.1);
        }
        .admin-panel h3 { color: var(--warning-color); margin-top: 0; }
        
        /* Yeni referans giri≈ü kutusu stilleri */
        .referral-input-container {
            margin-top: 20px;
            padding: 15px;
            background-color: var(--secondary-bg-color);
            border-radius: 10px;
            border: 1px solid var(--border-color);
        }
        
        .referral-input-group {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .referral-input-group input {
            flex: 1;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            background-color: #f5f9ff;
            color: var(--tg-theme-text-color);
        }
        
        .referral-input-group button {
            padding: 12px 20px;
            background: linear-gradient(145deg, var(--tg-theme-button-color), #1a6fd9);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }
        
        /* Loading indicator */
        .btn-loading {
            position: relative;
            pointer-events: none;
        }
        
        .btn-loading::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            top: 50%;
            left: 50%;
            margin-left: -10px;
            margin-top: -10px;
            border: 2px solid transparent;
            border-top: 2px solid #ffffff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* USDT Price Chart Styles */
        .price-chart {
            background-color: var(--secondary-bg-color);
            padding: 15px;
            border-radius: 12px;
            margin: 15px 0;
            border: 1px solid var(--border-color);
        }
        
        .price-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .current-price {
            font-size: 18px;
            font-weight: bold;
        }
        
        .price-change {
            font-size: 14px;
            padding: 4px 8px;
            border-radius: 6px;
        }
        
        .price-change.positive {
            background-color: rgba(0, 217, 126, 0.15);
            color: var(--success-color);
        }
        
        .price-change.negative {
            background-color: rgba(230, 55, 87, 0.15);
            color: var(--danger-color);
        }
        
        .chart-placeholder {
            height: 60px;
            background: linear-gradient(90deg, #e1efff 0%, #d1e3ff 50%, #e1efff 100%);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--tg-theme-hint-color);
            font-size: 14px;
        }

        /* Referans kod kutusu */
        .referral-code-box {
            background-color: #f0f7ff;
            padding: 15px;
            border-radius: 10px;
            border: 1px dashed var(--tg-theme-hint-color);
            margin-top: 15px;
            cursor: pointer;
            color: #1a365d;
            transition: background-color 0.2s;
            text-align: center;
            font-weight: bold;
            font-size: 18px;
            letter-spacing: 2px;
        }
        
        .referral-code-box:hover {
            background-color: #e1efff;
        }
        
        /* Admin View Styles */
        #admin-view { display: none; }
        
        .admin-stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .admin-stat-card {
            background-color: var(--secondary-bg-color);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            text-align: center;
        }
        
        .admin-stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #1a365d;
            margin-bottom: 5px;
        }
        
        .admin-stat-label {
            font-size: 12px;
            color: var(--tg-theme-hint-color);
            text-transform: uppercase;
        }
        
        .admin-controls {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
        }
        
        .admin-control-btn {
            padding: 12px;
            background: linear-gradient(145deg, var(--warning-color), #e6b400);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }
        
        .admin-control-btn.danger {
            background: linear-gradient(145deg, var(--danger-color), #c41a3a);
        }
        
        .admin-user-list {
            max-height: 300px;
            overflow-y: auto;
            margin-top: 15px;
            text-align: left;
        }
        
        .admin-user-item {
            padding: 10px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .admin-user-info {
            flex: 1;
        }
        
        .admin-user-id {
            font-weight: bold;
            color: #1a365d;
        }
        
        .admin-user-balance {
            font-size: 12px;
            color: var(--tg-theme-hint-color);
        }
        
        .admin-user-actions {
            display: flex;
            gap: 5px;
        }
        
        .admin-action-btn {
            padding: 5px 10px;
            background-color: var(--tg-theme-button-color);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
        }
        
        /* Task View Styles */
        #tasks-view { display: none; }
        
        .task-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .task-item {
            background-color: var(--secondary-bg-color);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .task-info {
            flex: 1;
            text-align: left;
        }
        
        .task-title {
            font-weight: bold;
            color: #1a365d;
            margin-bottom: 5px;
        }
        
        .task-description {
            font-size: 14px;
            color: var(--tg-theme-hint-color);
        }
        
        .task-reward {
            font-weight: bold;
            color: var(--success-color);
        }
        
        .task-btn {
            padding: 8px 15px;
            background: linear-gradient(145deg, var(--tg-theme-button-color), #1a6fd9);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }
        
        /* About View Styles */
        #about-view { display: none; }
        
        .about-content {
            text-align: left;
            line-height: 1.6;
        }
        
        .about-section {
            margin-bottom: 20px;
        }
        
        .about-section h3 {
            color: #1a365d;
            margin-bottom: 10px;
        }
        
        .about-section p {
            color: var(--tg-theme-hint-color);
            margin-bottom: 10px;
        }
        
        .roadmap-item {
            margin-bottom: 15px;
            padding-left: 15px;
            border-left: 3px solid var(--tg-theme-button-color);
        }
        
        .roadmap-date {
            font-weight: bold;
            color: #1a365d;
        }
        
        .roadmap-content {
            color: var(--tg-theme-hint-color);
        }
        
        /* Withdraw Requests Styles */
        .withdraw-requests-list {
            max-height: 300px;
            overflow-y: auto;
            margin-top: 15px;
            text-align: left;
        }
        
        .withdraw-request-item {
            padding: 10px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .withdraw-request-info {
            flex: 1;
        }
        
        .withdraw-request-user {
            font-weight: bold;
            color: #1a365d;
        }
        
        .withdraw-request-details {
            font-size: 12px;
            color: var(--tg-theme-hint-color);
        }
        
        .withdraw-request-actions {
            display: flex;
            gap: 5px;
        }
        
        .withdraw-action-btn {
            padding: 5px 10px;
            background-color: var(--tg-theme-button-color);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .withdraw-action-btn.approve {
            background-color: var(--success-color);
        }
        
        .withdraw-action-btn.reject {
            background-color: var(--danger-color);
        }
        
        /* Task Creation Styles */
        .task-creation-form {
            margin-top: 20px;
            padding: 15px;
            background-color: var(--secondary-bg-color);
            border-radius: 10px;
            border: 1px solid var(--border-color);
        }
        
        .form-row {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .form-row .input-group {
            flex: 1;
            margin-bottom: 0;
        }
        
        /* Task Marketplace Styles */
        #task-marketplace-view { display: none; }
        
        .marketplace-task-item {
            background-color: var(--secondary-bg-color);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            margin-bottom: 15px;
            text-align: left;
        }
        
        .marketplace-task-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .marketplace-task-title {
            font-weight: bold;
            color: #1a365d;
            font-size: 16px;
        }
        
        .marketplace-task-cost {
            font-weight: bold;
            color: var(--danger-color);
        }
        
        .marketplace-task-description {
            font-size: 14px;
            color: var(--tg-theme-hint-color);
            margin-bottom: 10px;
        }
        
        .marketplace-task-details {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: var(--tg-theme-hint-color);
            margin-bottom: 10px;
        }
        
        .marketplace-task-timer {
            color: var(--danger-color);
            font-weight: bold;
        }
        
        .marketplace-task-actions {
            display: flex;
            gap: 10px;
        }
        
        .marketplace-task-btn {
            flex: 1;
            padding: 8px;
            background: linear-gradient(145deg, var(--tg-theme-button-color), #1a6fd9);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }
        
        .marketplace-task-btn:disabled {
            background: #c5d9ff;
            color: #8ba7d0;
            cursor: not-allowed;
        }
        
        /* Task Creation View */
        #task-creation-view { display: none; }
        
        /* Referral Link Styles */
        .referral-link-box {
            background-color: #f0f7ff;
            padding: 15px;
            border-radius: 10px;
            border: 1px dashed var(--tg-theme-hint-color);
            margin-top: 15px;
            cursor: pointer;
            color: #1a365d;
            transition: background-color 0.2s;
            text-align: center;
            font-weight: bold;
            word-break: break-all;
        }
        
        .referral-link-box:hover {
            background-color: #e1efff;
        }
        
        .referral-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }
        
        .referral-stat-item {
            background-color: var(--secondary-bg-color);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }
        
        .referral-stat-value {
            font-size: 20px;
            font-weight: bold;
            color: #1a365d;
            margin-bottom: 5px;
        }
        
        .referral-stat-label {
            font-size: 12px;
            color: var(--tg-theme-hint-color);
        }
        
        /* Progress bar for tasks */
        .progress-bar {
            width: 100%;
            height: 8px;
            background-color: #e1efff;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(145deg, var(--success-color), #00b86c);
            border-radius: 4px;
            transition: width 0.3s ease;
        }
        
        .task-progress {
            font-size: 12px;
            color: var(--tg-theme-hint-color);
            text-align: center;
        }

        /* Percentage selector styles */
        .percentage-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .percentage-btn {
            flex: 1;
            padding: 10px;
            background-color: #f5f9ff;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            font-weight: 600;
            transition: all 0.2s;
        }
        
        .percentage-btn.active {
            background: linear-gradient(145deg, var(--tg-theme-button-color), #1a6fd9);
            color: white;
            border-color: var(--tg-theme-button-color);
        }
        
        /* Admin advanced panel */
        .admin-advanced-panel {
            margin-top: 20px;
            padding: 15px;
            background-color: rgba(246, 195, 67, 0.1);
            border-radius: 10px;
            border: 1px solid var(--warning-color);
        }
        
        .admin-advanced-panel h3 {
            color: var(--warning-color);
            margin-top: 0;
        }
        
        .admin-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .admin-tab {
            padding: 8px 15px;
            background-color: #f5f9ff;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }
        
        .admin-tab.active {
            background: linear-gradient(145deg, var(--tg-theme-button-color), #1a6fd9);
            color: white;
            border-color: var(--tg-theme-button-color);
        }
        
        .admin-tab-content {
            display: none;
        }
        
        .admin-tab-content.active {
            display: block;
        }

        /* Ad loading overlay */
        .ad-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            flex-direction: column;
            color: white;
        }

        .ad-loading {
            font-size: 18px;
            margin-bottom: 20px;
        }

        .ad-close-btn {
            margin-top: 20px;
            padding: 10px 20px;
            background: var(--danger-color);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Home / Task View -->
        <div id="home-view" class="view">
            <div class="header"><h1>TorreAds</h1><p>Reklam ƒ∞zle ve USDT Kazan</p></div>
            
            <!-- USDT Price Chart -->
            <div class="price-chart">
                <div class="price-info">
                    <div class="current-price">USDT: $<span id="usdtPrice">1.00</span></div>
                    <div class="price-change" id="priceChange">0.00%</div>
                </div>
                <div class="chart-placeholder" id="chartPlaceholder">
                    Canlƒ± USDT Fiyat Grafiƒüi
                </div>
            </div>
            
            <div class="card">
                <h2>Mevcut Bakiye</h2>
                <div class="balance-amount" id="balanceDisplay">USDT 0.00</div>
                <div class="ad-info-grid">
                    <div class="ad-info-item"><h3 id="adCountDisplay">0</h3><p>Toplam ƒ∞zlenen Reklam</p></div>
                    <div class="ad-info-item"><h3 id="dailyAdCountDisplay">0 / 100</h3><p>Bug√ºnk√º Reklamlar</p></div>
                </div>
            </div>
            <div class="ad-buttons">
                <button class="btn" id="rewardedBtn">Reklam ƒ∞zle (+0.002 USDT)</button>
                <button class="btn" id="bonusAdBtn">Bonus Reklam (+0.005 USDT)</button>
            </div>
            <button class="btn" id="mainWithdrawBtn" disabled>√áekim Yapmak ƒ∞√ßin 0.50 USDT'ye Ula≈ü</button>
            
            <!-- Admin Panel -->
            <div class="admin-panel" id="adminPanel">
                <h3>üëë Y√∂netici Paneli</h3>
                <p id="userInfo"></p>
            </div>
        </div>

        <!-- Withdraw View -->
        <div id="withdraw-view" class="view">
            <div class="header"><h1>Para √áekme</h1><p>Kazancƒ±nƒ±zƒ± talep edin</p></div>
            <div class="card">
                <h2>Bakiyeniz</h2>
                <div class="balance-amount" id="withdrawBalanceDisplay">USDT 0.00</div>
                <p style="color: var(--tg-theme-hint-color); margin-top: 15px;">Minimum √ßekim miktarƒ± 0.50 USDT'dir.</p>
            </div>
            <div class="card">
                <h2>√ñdeme Detaylarƒ±</h2>
                <div class="input-group">
                    <label for="paymentAddress">USDT C√ºzdan Adresiniz (TRC20)</label>
                    <input type="text" id="paymentAddress" placeholder="√∂rn: T... (TRC20 Adresi)">
                </div>
                <button class="btn" id="finalWithdrawBtn" disabled>Para √áek</button>
            </div>
        </div>
        
        <!-- Referral View -->
        <div id="referral-view" class="view">
            <div class="header"><h1>Referanslar</h1><p>Arkada≈ülarƒ±nƒ± davet et ve daha fazla kazan!</p></div>
            
            <div class="card">
                <h2>Referans ƒ∞statistikleriniz</h2>
                <div class="referral-stats">
                    <div class="referral-stat-item">
                        <div class="referral-stat-value" id="referralCountDisplay">0</div>
                        <div class="referral-stat-label">Toplam Referans</div>
                    </div>
                    <div class="referral-stat-item">
                        <div class="referral-stat-value" id="referralBonusDisplay">USDT 0.00</div>
                        <div class="referral-stat-label">Referans Kazancƒ±</div>
                    </div>
                </div>
            </div>
            
            <!-- Manuel Referans Giri≈ü Kutusu -->
            <div class="card">
                <h2>Referans Kodunu Girin</h2>
                <p>Eƒüer birisi sizi referans ettiyse, bonus almak i√ßin kodunu buraya girin!</p>
                <div class="referral-input-container">
                    <div class="referral-input-group">
                        <input type="text" id="referralCodeInput" placeholder="Referans kodunu girin">
                        <button id="submitReferralBtn">G√∂nder</button>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <h2>Referans Kodunuz</h2>
                <p>Bu kodu arkada≈ülarƒ±nƒ±zla payla≈üƒ±n. Katƒ±lan her onaylanmƒ±≈ü arkada≈ü i√ßin 0.02 USDT kazanƒ±rsƒ±nƒ±z!</p>
                <div class="referral-code-box" id="referralCodeBox" title="Kopyalamak i√ßin tƒ±klayƒ±n">
                    <span id="userReferralCode">Y√ºkleniyor...</span>
                </div>
                <p style="font-size:12px; color:var(--tg-theme-hint-color); margin-top:15px;">Kodu kopyalamak i√ßin √ºzerine tƒ±klayƒ±n</p>
            </div>
            
            <div class="card">
                <h2>Referans Linkiniz</h2>
                <p>A≈üaƒüƒ±daki linki arkada≈ülarƒ±nƒ±zla payla≈üarak daha hƒ±zlƒ± kazanƒ±n!</p>
                <div class="referral-link-box" id="referralLinkBox" title="Kopyalamak i√ßin tƒ±klayƒ±n">
                    <span id="userReferralLink">Y√ºkleniyor...</span>
                </div>
                <p style="font-size:12px; color:var(--tg-theme-hint-color); margin-top:15px;">Linki kopyalamak i√ßin √ºzerine tƒ±klayƒ±n</p>
            </div>
        </div>
        
        <!-- Tasks View -->
        <div id="tasks-view" class="view">
            <div class="header"><h1>G√∂revler</h1><p>Ek g√∂revlerle daha fazla kazanƒ±n</p></div>
            
            <div class="card">
                <h2>Mevcut G√∂revler</h2>
                <div class="task-list" id="manualTasksList">
                    <!-- Manuel g√∂revler buraya eklenecek -->
                </div>
            </div>
            
            <div class="card">
                <h2>G√∂rev ƒ∞lerlemeniz</h2>
                <div class="ad-info-grid">
                    <div class="ad-info-item"><h3 id="completedTasks">0</h3><p>Tamamlanan G√∂revler</p></div>
                    <div class="ad-info-item"><h3 id="taskEarnings">USDT 0.00</h3><p>G√∂rev Kazancƒ±</p></div>
                </div>
            </div>
        </div>
        
        <!-- About View -->
        <div id="about-view" class="view">
            <div class="header"><h1>Hakkƒ±nda</h1><p>TorreAds hakkƒ±nda bilgiler</p></div>
            
            <div class="card">
                <h2>Uygulama Bilgileri</h2>
                <div class="about-content">
                    <div class="about-section">
                        <h3>TorreAds Nedir?</h3>
                        <p>TorreAds, Telegram kullanƒ±cƒ±larƒ±nƒ±n reklam izleyerek ve g√∂revleri tamamlayarak USDT kazanabileceƒüi bir platformdur.</p>
                    </div>
                    
                    <div class="about-section">
                        <h3>Nasƒ±l √áalƒ±≈üƒ±r?</h3>
                        <p>1. Reklam izleyerek USDT kazanƒ±n<br>2. Arkada≈ülarƒ±nƒ±zƒ± davet ederek ekstra kazanƒ±n<br>3. G√∂revleri tamamlayarak kazancƒ±nƒ±zƒ± artƒ±rƒ±n<br>4. Bakiyeniz 0.50 USDT'ye ula≈ütƒ±ƒüƒ±nda √ßekim yapƒ±n</p>
                    </div>
                    
                    <div class="about-section">
                        <h3>Geli≈ütirme Yol Haritasƒ±</h3>
                        <div class="roadmap-item">
                            <div class="roadmap-date">≈ûubat 2024</div>
                            <div class="roadmap-content">Beta s√ºr√ºm√º yayƒ±nlandƒ±</div>
                        </div>
                        <div class="roadmap-item">
                            <div class="roadmap-date">Mart 2024</div>
                            <div class="roadmap-content">G√∂rev pazarƒ± eklendi</div>
                        </div>
                        <div class="roadmap-item">
                            <div class="roadmap-date">Nisan 2024</div>
                            <div class="roadmap-content">Multi-chain desteƒüi eklenecek</div>
                        </div>
                    </div>
                    
                    <div class="about-section">
                        <h3>ƒ∞leti≈üim</h3>
                        <p>Herhangi bir sorunuz veya √∂neriniz varsa, l√ºtfen destek ekibimizle ileti≈üime ge√ßin.</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Admin View -->
        <div id="admin-view" class="view">
            <div class="header"><h1>Admin Paneli</h1><p>Uygulama y√∂netimi ve kullanƒ±cƒ± kontrol√º</p></div>
            
            <div class="card">
                <h2>Genel ƒ∞statistikler</h2>
                <div class="admin-stats-grid">
                    <div class="admin-stat-card">
                        <div class="admin-stat-value" id="totalUsers">0</div>
                        <div class="admin-stat-label">Toplam Kullanƒ±cƒ±</div>
                    </div>
                    <div class="admin-stat-card">
                        <div class="admin-stat-value" id="totalAds">0</div>
                        <div class="admin-stat-label">Toplam Reklam</div>
                    </div>
                    <div class="admin-stat-card">
                        <div class="admin-stat-value" id="totalWithdrawals">0</div>
                        <div class="admin-stat-label">Toplam √áekim</div>
                    </div>
                    <div class="admin-stat-card">
                        <div class="admin-stat-value" id="totalBalance">USDT 0.00</div>
                        <div class="admin-stat-label">Toplam Bakiye</div>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <h2>Kullanƒ±cƒ± Y√∂netimi</h2>
                <div class="input-group">
                    <label for="userSearch">Kullanƒ±cƒ± Ara (ID veya ƒ∞sim)</label>
                    <input type="text" id="userSearch" placeholder="Kullanƒ±cƒ± ID veya isim girin">
                </div>
                <button class="btn" id="searchUserBtn">Ara</button>
                
                <div class="admin-user-list" id="adminUserList">
                    <!-- Kullanƒ±cƒ±lar buraya eklenecek -->
                </div>
            </div>
            
            <div class="card">
                <h2>√áekim Talepleri</h2>
                <div class="withdraw-requests-list" id="withdrawRequestsList">
                    <!-- √áekim talepleri buraya eklenecek -->
                </div>
            </div>
            
            <div class="admin-advanced-panel">
                <h3>Geli≈ümi≈ü Y√∂netim</h3>
                <div class="admin-tabs">
                    <button class="admin-tab active" data-tab="system">Sistem</button>
                    <button class="admin-tab" data-tab="tasks">G√∂revler</button>
                    <button class="admin-tab" data-tab="rewards">√ñd√ºller</button>
                </div>
                
                <div class="admin-tab-content active" id="system-tab">
                    <div class="admin-controls">
                        <button class="admin-control-btn" id="resetAdsBtn">G√ºnl√ºk Reklamlarƒ± Sƒ±fƒ±rla</button>
                        <button class="admin-control-btn" id="updateRewardsBtn">√ñd√ºlleri G√ºncelle</button>
                        <button class="admin-control-btn danger" id="clearDataBtn">T√ºm Verileri Temizle</button>
                    </div>
                </div>
                
                <div class="admin-tab-content" id="tasks-tab">
                    <div class="admin-controls">
                        <button class="admin-control-btn" id="addTaskBtn">Yeni G√∂rev Ekle</button>
                        <button class="admin-control-btn" id="removeTaskBtn">G√∂rev Kaldƒ±r</button>
                        <button class="admin-control-btn" id="updateTasksBtn">G√∂revleri G√ºncelle</button>
                    </div>
                </div>
                
                <div class="admin-tab-content" id="rewards-tab">
                    <div class="admin-controls">
                        <button class="admin-control-btn" id="updateAdRewardBtn">Reklam √ñd√ºl√ºn√º G√ºncelle</button>
                        <button class="admin-control-btn" id="updateReferralRewardBtn">Referans √ñd√ºl√ºn√º G√ºncelle</button>
                        <button class="admin-control-btn" id="updateMinWithdrawBtn">Min. √áekim Miktarƒ±nƒ± G√ºncelle</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Ad Loading Overlay -->
    <div class="ad-overlay" id="adOverlay">
        <div class="ad-loading" id="adLoadingText">Reklam y√ºkleniyor...</div>
        <button class="ad-close-btn" id="adCloseBtn">Reklamƒ± Kapat</button>
    </div>

    <!-- Status Messages -->
    <div class="status-message" id="statusMessage"></div>

    <!-- Footer Navigation -->
    <div class="footer-nav">
        <button class="nav-btn active" data-view="home-view">
            <svg class="icon" viewBox="0 0 24 24" fill="currentColor">
                <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
            </svg>
            Ana Sayfa
        </button>
        <button class="nav-btn" data-view="referral-view">
            <svg class="icon" viewBox="0 0 24 24" fill="currentColor">
                <path d="M16 6l2.29 2.29-4.88 4.88-4-4L2 16.59 3.41 18l6-6 4 4 6.3-6.29L22 12V6z"/>
            </svg>
            Referans
        </button>
        <button class="nav-btn" data-view="tasks-view">
            <svg class="icon" viewBox="0 0 24 24" fill="currentColor">
                <path d="M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm2 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/>
            </svg>
            G√∂revler
        </button>
        <button class="nav-btn" data-view="withdraw-view">
            <svg class="icon" viewBox="0 0 24 24" fill="currentColor">
                <path d="M17 8H7c-2.21 0-4 1.79-4 4s1.79 4 4 4h10c2.21 0 4-1.79 4-4s-1.79-4-4-4zm-5 6c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z"/>
            </svg>
            √áekim
        </button>
        <button class="nav-btn" data-view="about-view">
            <svg class="icon" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/>
            </svg>
            Hakkƒ±nda
        </button>
    </div>

    <script>
        // Telegram Web App initialization
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.enableClosingConfirmation();
        tg.MainButton.hide();
        
        // Admin user IDs
        const ADMIN_USER_IDS = ['8401848644', '7904032877'];
        
        // App state
        let userData = {
            userId: '',
            balance: 0,
            adCount: 0,
            dailyAdCount: 0,
            lastAdDate: '',
            referralCode: '',
            referredBy: '',
            referrals: [],
            referralBonus: 0,
            completedTasks: [],
            taskEarnings: 0,
            withdrawHistory: [],
            paymentAddress: '',
            bonusAdAvailable: true
        };
        
        let appData = {
            adReward: 0.002,
            bonusAdReward: 0.005,
            referralReward: 0.02,
            minWithdraw: 0.50,
            totalUsers: 0,
            totalAds: 0,
            totalWithdrawals: 0,
            totalBalance: 0,
            manualTasks: [],
            withdrawRequests: []
        };
        
        // DOM elements
        const views = document.querySelectorAll('.view');
        const navButtons = document.querySelectorAll('.nav-btn');
        const statusMessage = document.getElementById('statusMessage');
        const adOverlay = document.getElementById('adOverlay');
        const adLoadingText = document.getElementById('adLoadingText');
        const adCloseBtn = document.getElementById('adCloseBtn');
        
        // Initialize the app
        function initApp() {
            // Get user data from Telegram
            const initData = tg.initDataUnsafe;
            userData.userId = initData.user?.id || 'test_user_' + Math.floor(Math.random() * 10000);
            userData.username = initData.user?.username || 'Kullanƒ±cƒ±';
            userData.firstName = initData.user?.first_name || 'Kullanƒ±cƒ±';
            
            // Load data from localStorage
            loadUserData();
            loadAppData();
            
            // Generate referral code if not exists
            if (!userData.referralCode) {
                userData.referralCode = generateReferralCode();
                saveUserData();
            }
            
            // Check if user is admin
            if (ADMIN_USER_IDS.includes(userData.userId.toString())) {
                document.getElementById('adminPanel').style.display = 'block';
                // Add admin button to navigation
                addAdminNavButton();
            }
            
            // Update UI
            updateUI();
            
            // Initialize event listeners
            initEventListeners();
            
            // Show welcome message
            showStatusMessage(`Ho≈ü geldiniz, ${userData.firstName}!`, 'success');
        }
        
        // Load user data from localStorage
        function loadUserData() {
            const savedUserData = localStorage.getItem(`torreads_user_${userData.userId}`);
            if (savedUserData) {
                const parsedData = JSON.parse(savedUserData);
                userData = { ...userData, ...parsedData };
            }
            
            // Check if daily ad count needs to be reset
            const today = new Date().toDateString();
            if (userData.lastAdDate !== today) {
                userData.dailyAdCount = 0;
                userData.lastAdDate = today;
                userData.bonusAdAvailable = true;
                saveUserData();
            }
        }
        
        // Save user data to localStorage
        function saveUserData() {
            localStorage.setItem(`torreads_user_${userData.userId}`, JSON.stringify(userData));
        }
        
        // Load app data from localStorage
        function loadAppData() {
            const savedAppData = localStorage.getItem('torreads_app_data');
            if (savedAppData) {
                const parsedData = JSON.parse(savedAppData);
                appData = { ...appData, ...parsedData };
            }
            
            // Calculate totals
            calculateTotals();
        }
        
        // Save app data to localStorage
        function saveAppData() {
            localStorage.setItem('torreads_app_data', JSON.stringify(appData));
        }
        
        // Calculate total statistics
        function calculateTotals() {
            appData.totalUsers = 0;
            appData.totalAds = 0;
            appData.totalWithdrawals = 0;
            appData.totalBalance = 0;
            
            // Calculate from all users
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key && key.startsWith('torreads_user_')) {
                    const user = JSON.parse(localStorage.getItem(key));
                    appData.totalUsers++;
                    appData.totalAds += user.adCount || 0;
                    appData.totalBalance += user.balance || 0;
                    appData.totalWithdrawals += user.withdrawHistory ? user.withdrawHistory.length : 0;
                }
            }
        }
        
        // Generate a unique referral code
        function generateReferralCode() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let result = '';
            for (let i = 0; i < 8; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }
        
        // Update UI with current data
        function updateUI() {
            // Update balance
            document.getElementById('balanceDisplay').textContent = `USDT ${userData.balance.toFixed(3)}`;
            document.getElementById('withdrawBalanceDisplay').textContent = `USDT ${userData.balance.toFixed(3)}`;
            
            // Update ad counts
            document.getElementById('adCountDisplay').textContent = userData.adCount;
            document.getElementById('dailyAdCountDisplay').textContent = `${userData.dailyAdCount} / 100`;
            
            // Update referral stats
            document.getElementById('referralCountDisplay').textContent = userData.referrals.length;
            document.getElementById('referralBonusDisplay').textContent = `USDT ${userData.referralBonus.toFixed(3)}`;
            
            // Update task stats
            document.getElementById('completedTasks').textContent = userData.completedTasks.length;
            document.getElementById('taskEarnings').textContent = `USDT ${userData.taskEarnings.toFixed(3)}`;
            
            // Update referral code and link
            document.getElementById('userReferralCode').textContent = userData.referralCode;
            document.getElementById('userReferralLink').textContent = `https://t.me/torreadstest_bot?start=${userData.referralCode}`;
            
            // Update withdraw button state
            const withdrawBtn = document.getElementById('mainWithdrawBtn');
            const finalWithdrawBtn = document.getElementById('finalWithdrawBtn');
            
            if (userData.balance >= appData.minWithdraw) {
                withdrawBtn.disabled = false;
                withdrawBtn.textContent = `Para √áek (USDT ${userData.balance.toFixed(3)})`;
                finalWithdrawBtn.disabled = false;
            } else {
                withdrawBtn.disabled = true;
                withdrawBtn.textContent = `√áekim Yapmak ƒ∞√ßin ${appData.minWithdraw.toFixed(2)} USDT'ye Ula≈ü`;
                finalWithdrawBtn.disabled = true;
            }
            
            // Update payment address if exists
            if (userData.paymentAddress) {
                document.getElementById('paymentAddress').value = userData.paymentAddress;
            }
            
            // Update bonus ad button
            const bonusAdBtn = document.getElementById('bonusAdBtn');
            if (userData.bonusAdAvailable) {
                bonusAdBtn.disabled = false;
                bonusAdBtn.textContent = `Bonus Reklam (+${appData.bonusAdReward.toFixed(3)} USDT)`;
            } else {
                bonusAdBtn.disabled = true;
                bonusAdBtn.textContent = 'Bonus Reklam (Yarƒ±n Tekrar)';
            }
            
            // Update admin panel if visible
            if (ADMIN_USER_IDS.includes(userData.userId.toString())) {
                updateAdminPanel();
            }
            
            // Update manual tasks
            updateManualTasks();
        }
        
        // Initialize event listeners
        function initEventListeners() {
            // Navigation buttons
            navButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const targetView = button.getAttribute('data-view');
                    switchView(targetView);
                    
                    // Update active nav button
                    navButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                });
            });
            
            // Rewarded ad buttons
            document.getElementById('rewardedBtn').addEventListener('click', () => showAd('normal'));
            document.getElementById('bonusAdBtn').addEventListener('click', () => showAd('bonus'));
            
            // Withdraw buttons
            document.getElementById('mainWithdrawBtn').addEventListener('click', () => {
                switchView('withdraw-view');
                navButtons.forEach(btn => btn.classList.remove('active'));
                document.querySelector('.nav-btn[data-view="withdraw-view"]').classList.add('active');
            });
            
            document.getElementById('finalWithdrawBtn').addEventListener('click', processWithdrawal);
            
            // Referral code copy
            document.getElementById('referralCodeBox').addEventListener('click', () => {
                copyToClipboard(userData.referralCode);
                showStatusMessage('Referans kodu kopyalandƒ±!', 'success');
            });
            
            document.getElementById('referralLinkBox').addEventListener('click', () => {
                copyToClipboard(`https://t.me/torreadstest_bot?start=${userData.referralCode}`);
                showStatusMessage('Referans linki kopyalandƒ±!', 'success');
            });
            
            // Manuel referans giri≈üi
            document.getElementById('submitReferralBtn').addEventListener('click', submitReferralCode);
            
            // Admin controls
            document.getElementById('searchUserBtn').addEventListener('click', searchUser);
            document.getElementById('resetAdsBtn').addEventListener('click', resetDailyAds);
            document.getElementById('updateRewardsBtn').addEventListener('click', updateRewards);
            document.getElementById('clearDataBtn').addEventListener('click', clearAllData);
            
            // Admin tabs
            document.querySelectorAll('.admin-tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabId = tab.getAttribute('data-tab');
                    
                    // Update active tab
                    document.querySelectorAll('.admin-tab').forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    
                    // Show corresponding content
                    document.querySelectorAll('.admin-tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    document.getElementById(`${tabId}-tab`).classList.add('active');
                });
            });
            
            // Ad overlay close button
            adCloseBtn.addEventListener('click', closeAdOverlay);
        }
        
        // Show ad with GigaPub
        async function showAd(adType) {
            // Check daily limit for normal ads
            if (adType === 'normal' && userData.dailyAdCount >= 100) {
                showStatusMessage('Bug√ºnk√º reklam limitinize ula≈ütƒ±nƒ±z. Yarƒ±n tekrar deneyin!', 'error');
                return;
            }
            
            // Check if bonus ad is available
            if (adType === 'bonus' && !userData.bonusAdAvailable) {
                showStatusMessage('Bug√ºnk√º bonus reklamƒ±nƒ±zƒ± zaten kullandƒ±nƒ±z. Yarƒ±n tekrar deneyin!', 'error');
                return;
            }
            
            const adBtn = adType === 'normal' ? 
                document.getElementById('rewardedBtn') : 
                document.getElementById('bonusAdBtn');
            
            // Show loading state
            adBtn.classList.add('btn-loading');
            adBtn.disabled = true;
            
            try {
                // Show ad overlay
                adOverlay.style.display = 'flex';
                adLoadingText.textContent = 'Reklam y√ºkleniyor...';
                
                // Show GigaPub ad
                await window.showGiga("main");
                
                // Ad successfully shown - give reward
                const reward = adType === 'normal' ? appData.adReward : appData.bonusAdReward;
                
                // Update user data
                userData.balance += reward;
                userData.adCount++;
                
                if (adType === 'normal') {
                    userData.dailyAdCount++;
                } else {
                    userData.bonusAdAvailable = false;
                }
                
                userData.lastAdDate = new Date().toDateString();
                
                // Save data
                saveUserData();
                updateUI();
                
                // Show success message
                showStatusMessage(`Tebrikler! ${reward.toFixed(3)} USDT kazandƒ±nƒ±z.`, 'success');
                
                // Update app totals
                calculateTotals();
                saveAppData();
                
            } catch (error) {
                console.error('Ad error:', error);
                showStatusMessage('Reklam y√ºklenirken bir hata olu≈ütu. L√ºtfen tekrar deneyin.', 'error');
            } finally {
                // Remove loading state
                adBtn.classList.remove('btn-loading');
                adBtn.disabled = false;
                
                // Close ad overlay
                closeAdOverlay();
            }
        }
        
        // Close ad overlay
        function closeAdOverlay() {
            adOverlay.style.display = 'none';
        }
        
        // Switch between views
        function switchView(viewId) {
            views.forEach(view => {
                view.style.display = 'none';
            });
            document.getElementById(viewId).style.display = 'block';
            
            // Special handling for admin view
            if (viewId === 'admin-view' && ADMIN_USER_IDS.includes(userData.userId.toString())) {
                updateAdminPanel();
            }
        }
        
        // Add admin navigation button
        function addAdminNavButton() {
            const footerNav = document.querySelector('.footer-nav');
            const adminButton = document.createElement('button');
            adminButton.className = 'nav-btn';
            adminButton.setAttribute('data-view', 'admin-view');
            adminButton.innerHTML = `
                <svg class="icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"/>
                </svg>
                Admin
            `;
            adminButton.addEventListener('click', () => {
                switchView('admin-view');
                navButtons.forEach(btn => btn.classList.remove('active'));
                adminButton.classList.add('active');
            });
            footerNav.appendChild(adminButton);
        }
        
        // Process withdrawal
        function processWithdrawal() {
            const paymentAddress = document.getElementById('paymentAddress').value.trim();
            
            // Validate payment address
            if (!paymentAddress) {
                showStatusMessage('L√ºtfen ge√ßerli bir USDT c√ºzdan adresi girin.', 'error');
                return;
            }
            
            if (userData.balance < appData.minWithdraw) {
                showStatusMessage(`√áekim yapmak i√ßin en az ${appData.minWithdraw.toFixed(2)} USDT'ye ihtiyacƒ±nƒ±z var.`, 'error');
                return;
            }
            
            // Save payment address
            userData.paymentAddress = paymentAddress;
            
            // Create withdrawal request
            const withdrawal = {
                id: Date.now().toString(),
                userId: userData.userId,
                amount: userData.balance,
                address: paymentAddress,
                date: new Date().toISOString(),
                status: 'pending'
            };
            
            // Add to user's withdrawal history
            if (!userData.withdrawHistory) {
                userData.withdrawHistory = [];
            }
            userData.withdrawHistory.push(withdrawal);
            
            // Add to app's withdrawal requests
            appData.withdrawRequests.push(withdrawal);
            
            // Reset user balance
            userData.balance = 0;
            
            // Save data
            saveUserData();
            saveAppData();
            
            // Update UI
            updateUI();
            
            // Show success message
            showStatusMessage(`√áekim talebiniz alƒ±ndƒ±. ${withdrawal.amount.toFixed(3)} USDT yakƒ±nda ${paymentAddress} adresine g√∂nderilecek.`, 'success');
            
            // Switch to home view
            switchView('home-view');
            navButtons.forEach(btn => btn.classList.remove('active'));
            document.querySelector('.nav-btn[data-view="home-view"]').classList.add('active');
        }
        
        // Submit referral code
        function submitReferralCode() {
            const referralCodeInput = document.getElementById('referralCodeInput');
            const referralCode = referralCodeInput.value.trim().toUpperCase();
            
            if (!referralCode) {
                showStatusMessage('L√ºtfen bir referans kodu girin.', 'error');
                return;
            }
            
            // Check if user already used a referral code
            if (userData.referredBy) {
                showStatusMessage('Zaten bir referans kodu kullandƒ±nƒ±z.', 'error');
                return;
            }
            
            // Check if user is trying to use their own code
            if (referralCode === userData.referralCode) {
                showStatusMessage('Kendi referans kodunuzu kullanamazsƒ±nƒ±z.', 'error');
                return;
            }
            
            // Find the referrer
            let referrerFound = false;
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key && key.startsWith('torreads_user_')) {
                    const user = JSON.parse(localStorage.getItem(key));
                    if (user.referralCode === referralCode) {
                        // Update current user
                        userData.referredBy = user.userId;
                        
                        // Update referrer
                        if (!user.referrals) {
                            user.referrals = [];
                        }
                        user.referrals.push({
                            userId: userData.userId,
                            date: new Date().toISOString()
                        });
                        user.referralBonus += appData.referralReward;
                        
                        // Save both users
                        saveUserData();
                        localStorage.setItem(key, JSON.stringify(user));
                        
                        referrerFound = true;
                        break;
                    }
                }
            }
            
            if (referrerFound) {
                showStatusMessage(`Referans kodunuz ba≈üarƒ±yla kaydedildi! ${appData.referralReward.toFixed(3)} USDT bonus kazandƒ±nƒ±z.`, 'success');
                referralCodeInput.value = '';
                updateUI();
            } else {
                showStatusMessage('Ge√ßersiz referans kodu. L√ºtfen tekrar deneyin.', 'error');
            }
        }
        
        // Copy text to clipboard
        function copyToClipboard(text) {
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(text);
            } else {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
            }
        }
        
        // Show status message
        function showStatusMessage(message, type) {
            statusMessage.textContent = message;
            statusMessage.className = 'status-message';
            statusMessage.classList.add(type);
            
            setTimeout(() => {
                statusMessage.classList.remove(type);
                statusMessage.style.display = 'none';
            }, 5000);
        }
        
        // Update admin panel
        function updateAdminPanel() {
            // Update user info
            document.getElementById('userInfo').textContent = `Kullanƒ±cƒ±: ${userData.firstName} (${userData.userId})`;
            
            // Update admin stats
            document.getElementById('totalUsers').textContent = appData.totalUsers;
            document.getElementById('totalAds').textContent = appData.totalAds;
            document.getElementById('totalWithdrawals').textContent = appData.totalWithdrawals;
            document.getElementById('totalBalance').textContent = `USDT ${appData.totalBalance.toFixed(2)}`;
            
            // Update user list
            updateAdminUserList();
            
            // Update withdrawal requests
            updateWithdrawalRequests();
        }
        
        // Update admin user list
        function updateAdminUserList() {
            const userList = document.getElementById('adminUserList');
            userList.innerHTML = '';
            
            // Add users to list
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key && key.startsWith('torreads_user_')) {
                    const user = JSON.parse(localStorage.getItem(key));
                    
                    const userItem = document.createElement('div');
                    userItem.className = 'admin-user-item';
                    userItem.innerHTML = `
                        <div class="admin-user-info">
                            <div class="admin-user-id">${user.firstName || 'Kullanƒ±cƒ±'} (${user.userId})</div>
                            <div class="admin-user-balance">Bakiye: USDT ${(user.balance || 0).toFixed(3)} | Reklam: ${user.adCount || 0}</div>
                        </div>
                        <div class="admin-user-actions">
                            <button class="admin-action-btn" onclick="adminAddBalance('${user.userId}', 0.1)">+0.1</button>
                            <button class="admin-action-btn" onclick="adminAddBalance('${user.userId}', 1)">+1</button>
                            <button class="admin-action-btn" onclick="adminResetUser('${user.userId}')">Sƒ±fƒ±rla</button>
                        </div>
                    `;
                    userList.appendChild(userItem);
                }
            }
        }
        
        // Update withdrawal requests
        function updateWithdrawalRequests() {
            const requestsList = document.getElementById('withdrawRequestsList');
            requestsList.innerHTML = '';
            
            if (appData.withdrawRequests.length === 0) {
                requestsList.innerHTML = '<div style="text-align: center; color: var(--tg-theme-hint-color); padding: 20px;">Bekleyen √ßekim talebi yok.</div>';
                return;
            }
            
            // Add requests to list
            appData.withdrawRequests
                .filter(request => request.status === 'pending')
                .forEach(request => {
                    const requestItem = document.createElement('div');
                    requestItem.className = 'withdraw-request-item';
                    requestItem.innerHTML = `
                        <div class="withdraw-request-info">
                            <div class="withdraw-request-user">Kullanƒ±cƒ±: ${request.userId}</div>
                            <div class="withdraw-request-details">Miktar: USDT ${request.amount.toFixed(3)} | Adres: ${request.address}</div>
                        </div>
                        <div class="withdraw-request-actions">
                            <button class="withdraw-action-btn approve" onclick="adminProcessWithdrawal('${request.id}', 'approved')">Onayla</button>
                            <button class="withdraw-action-btn reject" onclick="adminProcessWithdrawal('${request.id}', 'rejected')">Reddet</button>
                        </div>
                    `;
                    requestsList.appendChild(requestItem);
                });
        }
        
        // Search user in admin panel
        function searchUser() {
            const searchTerm = document.getElementById('userSearch').value.trim().toLowerCase();
            const userList = document.getElementById('adminUserList');
            userList.innerHTML = '';
            
            let foundUsers = 0;
            
            // Search in users
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key && key.startsWith('torreads_user_')) {
                    const user = JSON.parse(localStorage.getItem(key));
                    
                    const userName = (user.firstName || '').toLowerCase();
                    const userId = user.userId.toString();
                    
                    if (userName.includes(searchTerm) || userId.includes(searchTerm)) {
                        const userItem = document.createElement('div');
                        userItem.className = 'admin-user-item';
                        userItem.innerHTML = `
                            <div class="admin-user-info">
                                <div class="admin-user-id">${user.firstName || 'Kullanƒ±cƒ±'} (${user.userId})</div>
                                <div class="admin-user-balance">Bakiye: USDT ${(user.balance || 0).toFixed(3)} | Reklam: ${user.adCount || 0}</div>
                            </div>
                            <div class="admin-user-actions">
                                <button class="admin-action-btn" onclick="adminAddBalance('${user.userId}', 0.1)">+0.1</button>
                                <button class="admin-action-btn" onclick="adminAddBalance('${user.userId}', 1)">+1</button>
                                <button class="admin-action-btn" onclick="adminResetUser('${user.userId}')">Sƒ±fƒ±rla</button>
                            </div>
                        `;
                        userList.appendChild(userItem);
                        foundUsers++;
                    }
                }
            }
            
            if (foundUsers === 0) {
                userList.innerHTML = '<div style="text-align: center; color: var(--tg-theme-hint-color); padding: 20px;">Kullanƒ±cƒ± bulunamadƒ±.</div>';
            }
        }
        
        // Admin: Add balance to user
        function adminAddBalance(userId, amount) {
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key && key.startsWith('torreads_user_')) {
                    const user = JSON.parse(localStorage.getItem(key));
                    if (user.userId === userId) {
                        user.balance += amount;
                        localStorage.setItem(key, JSON.stringify(user));
                        
                        // Update current user if it's the same
                        if (userData.userId === userId) {
                            userData.balance += amount;
                            updateUI();
                        }
                        
                        showStatusMessage(`${userId} kullanƒ±cƒ±sƒ±na ${amount} USDT eklendi.`, 'success');
                        updateAdminPanel();
                        return;
                    }
                }
            }
            
            showStatusMessage('Kullanƒ±cƒ± bulunamadƒ±.', 'error');
        }
        
        // Admin: Reset user
        function adminResetUser(userId) {
            if (confirm(`${userId} kullanƒ±cƒ±sƒ±nƒ± sƒ±fƒ±rlamak istediƒüinizden emin misiniz? T√ºm verileri silinecek.`)) {
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key && key.startsWith('torreads_user_')) {
                        const user = JSON.parse(localStorage.getItem(key));
                        if (user.userId === userId) {
                            // Reset user data but keep ID and referral code
                            const newUserData = {
                                userId: user.userId,
                                username: user.username,
                                firstName: user.firstName,
                                balance: 0,
                                adCount: 0,
                                dailyAdCount: 0,
                                lastAdDate: new Date().toDateString(),
                                referralCode: user.referralCode,
                                referredBy: user.referredBy,
                                referrals: user.referrals || [],
                                referralBonus: user.referralBonus || 0,
                                completedTasks: [],
                                taskEarnings: 0,
                                withdrawHistory: user.withdrawHistory || [],
                                paymentAddress: user.paymentAddress || '',
                                bonusAdAvailable: true
                            };
                            
                            localStorage.setItem(key, JSON.stringify(newUserData));
                            
                            // Update current user if it's the same
                            if (userData.userId === userId) {
                                userData = newUserData;
                                updateUI();
                            }
                            
                            showStatusMessage(`${userId} kullanƒ±cƒ±sƒ± sƒ±fƒ±rlandƒ±.`, 'success');
                            updateAdminPanel();
                            return;
                        }
                    }
                }
                
                showStatusMessage('Kullanƒ±cƒ± bulunamadƒ±.', 'error');
            }
        }
        
        // Admin: Process withdrawal
        function adminProcessWithdrawal(requestId, action) {
            const requestIndex = appData.withdrawRequests.findIndex(req => req.id === requestId);
            
            if (requestIndex === -1) {
                showStatusMessage('√áekim talebi bulunamadƒ±.', 'error');
                return;
            }
            
            const request = appData.withdrawRequests[requestIndex];
            
            if (action === 'approved') {
                // Mark as approved
                appData.withdrawRequests[requestIndex].status = 'approved';
                showStatusMessage(`√áekim talebi onaylandƒ±. ${request.amount.toFixed(3)} USDT ${request.address} adresine g√∂nderildi.`, 'success');
            } else {
                // Mark as rejected and return balance to user
                appData.withdrawRequests[requestIndex].status = 'rejected';
                
                // Find user and return balance
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key && key.startsWith('torreads_user_')) {
                        const user = JSON.parse(localStorage.getItem(key));
                        if (user.userId === request.userId) {
                            user.balance += request.amount;
                            
                            // Update withdrawal history
                            if (user.withdrawHistory) {
                                const userWithdrawalIndex = user.withdrawHistory.findIndex(w => w.id === requestId);
                                if (userWithdrawalIndex !== -1) {
                                    user.withdrawHistory[userWithdrawalIndex].status = 'rejected';
                                }
                            }
                            
                            localStorage.setItem(key, JSON.stringify(user));
                            
                            // Update current user if it's the same
                            if (userData.userId === request.userId) {
                                userData.balance += request.amount;
                                updateUI();
                            }
                            
                            break;
                        }
                    }
                }
                
                showStatusMessage('√áekim talebi reddedildi ve bakiye kullanƒ±cƒ±ya iade edildi.', 'success');
            }
            
            // Save app data
            saveAppData();
            
            // Update admin panel
            updateWithdrawalRequests();
        }
        
        // Admin: Reset daily ads for all users
        function resetDailyAds() {
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key && key.startsWith('torreads_user_')) {
                    const user = JSON.parse(localStorage.getItem(key));
                    user.dailyAdCount = 0;
                    user.lastAdDate = new Date().toDateString();
                    user.bonusAdAvailable = true;
                    localStorage.setItem(key, JSON.stringify(user));
                }
            }
            
            // Update current user
            userData.dailyAdCount = 0;
            userData.lastAdDate = new Date().toDateString();
            userData.bonusAdAvailable = true;
            saveUserData();
            updateUI();
            
            showStatusMessage('T√ºm kullanƒ±cƒ±larƒ±n g√ºnl√ºk reklam sayƒ±larƒ± sƒ±fƒ±rlandƒ±.', 'success');
        }
        
        // Admin: Update rewards
        function updateRewards() {
            const newAdReward = parseFloat(prompt('Yeni reklam √∂d√ºl√º (USDT):', appData.adReward));
            const newBonusAdReward = parseFloat(prompt('Yeni bonus reklam √∂d√ºl√º (USDT):', appData.bonusAdReward));
            const newReferralReward = parseFloat(prompt('Yeni referans √∂d√ºl√º (USDT):', appData.referralReward));
            const newMinWithdraw = parseFloat(prompt('Yeni minimum √ßekim miktarƒ± (USDT):', appData.minWithdraw));
            
            if (!isNaN(newAdReward) && newAdReward > 0) {
                appData.adReward = newAdReward;
            }
            
            if (!isNaN(newBonusAdReward) && newBonusAdReward > 0) {
                appData.bonusAdReward = newBonusAdReward;
            }
            
            if (!isNaN(newReferralReward) && newReferralReward > 0) {
                appData.referralReward = newReferralReward;
            }
            
            if (!isNaN(newMinWithdraw) && newMinWithdraw > 0) {
                appData.minWithdraw = newMinWithdraw;
            }
            
            saveAppData();
            updateUI();
            
            showStatusMessage('√ñd√ºller g√ºncellendi.', 'success');
        }
        
        // Admin: Clear all data
        function clearAllData() {
            if (confirm('T√úM verileri silmek istediƒüinizden emin misiniz? Bu i≈ülem geri alƒ±namaz!')) {
                // Clear all user data
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key && key.startsWith('torreads_user_')) {
                        localStorage.removeItem(key);
                        i--; // Adjust index after removal
                    }
                }
                
                // Clear app data
                localStorage.removeItem('torreads_app_data');
                
                // Reset current user data
                userData = {
                    userId: userData.userId,
                    username: userData.username,
                    firstName: userData.firstName,
                    balance: 0,
                    adCount: 0,
                    dailyAdCount: 0,
                    lastAdDate: new Date().toDateString(),
                    referralCode: generateReferralCode(),
                    referredBy: '',
                    referrals: [],
                    referralBonus: 0,
                    completedTasks: [],
                    taskEarnings: 0,
                    withdrawHistory: [],
                    paymentAddress: '',
                    bonusAdAvailable: true
                };
                
                // Reset app data
                appData = {
                    adReward: 0.002,
                    bonusAdReward: 0.005,
                    referralReward: 0.02,
                    minWithdraw: 0.50,
                    totalUsers: 0,
                    totalAds: 0,
                    totalWithdrawals: 0,
                    totalBalance: 0,
                    manualTasks: [],
                    withdrawRequests: []
                };
                
                // Save initial data
                saveUserData();
                saveAppData();
                
                // Update UI
                updateUI();
                updateAdminPanel();
                
                showStatusMessage('T√ºm veriler temizlendi.', 'success');
            }
        }
        
        // Update manual tasks
        function updateManualTasks() {
            const tasksList = document.getElementById('manualTasksList');
            tasksList.innerHTML = '';
            
            if (appData.manualTasks.length === 0) {
                tasksList.innerHTML = '<div style="text-align: center; color: var(--tg-theme-hint-color); padding: 20px;">Hen√ºz g√∂rev yok. G√∂revler yakƒ±nda eklenecek!</div>';
                return;
            }
            
            // Add tasks to list
            appData.manualTasks.forEach(task => {
                const isCompleted = userData.completedTasks.includes(task.id);
                
                const taskItem = document.createElement('div');
                taskItem.className = 'task-item';
                taskItem.innerHTML = `
                    <div class="task-info">
                        <div class="task-title">${task.title}</div>
                        <div class="task-description">${task.description}</div>
                    </div>
                    <div class="task-reward">${task.reward} USDT</div>
                    <button class="task-btn" ${isCompleted ? 'disabled' : ''} onclick="completeTask('${task.id}')">
                        ${isCompleted ? 'Tamamlandƒ±' : 'Ba≈üla'}
                    </button>
                `;
                tasksList.appendChild(taskItem);
            });
        }
        
        // Complete a task
        function completeTask(taskId) {
            const task = appData.manualTasks.find(t => t.id === taskId);
            
            if (!task) {
                showStatusMessage('G√∂rev bulunamadƒ±.', 'error');
                return;
            }
            
            if (userData.completedTasks.includes(taskId)) {
                showStatusMessage('Bu g√∂revi zaten tamamladƒ±nƒ±z.', 'error');
                return;
            }
            
            // Simulate task completion
            showStatusMessage('G√∂rev tamamlanƒ±yor...', 'info');
            
            setTimeout(() => {
                // Add to completed tasks
                userData.completedTasks.push(taskId);
                userData.taskEarnings += task.reward;
                userData.balance += task.reward;
                
                // Save data
                saveUserData();
                updateUI();
                
                showStatusMessage(`Tebrikler! ${task.reward} USDT kazandƒ±nƒ±z.`, 'success');
            }, 2000);
        }
        
        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', initApp);
        
        // Make functions available globally for onclick handlers
        window.adminAddBalance = adminAddBalance;
        window.adminResetUser = adminResetUser;
        window.adminProcessWithdrawal = adminProcessWithdrawal;
        window.completeTask = completeTask;
    </script>
</body>
</html>
