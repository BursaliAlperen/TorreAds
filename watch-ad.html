<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Reklam Ä°zle ve Kazan</title>
<script src='//libtl.com/sdk.js' data-zone='9441902' data-sdk='show_9441902'></script>
</head>
<body style="text-align:center; padding:50px; font-family:sans-serif;">

<h1>ğŸ¬ Reklam Ä°zle, Kazan!</h1>
<button id="watchAdBtn" disabled>ğŸ¥ Reklam Ä°zleniyor...</button>
<p id="status"></p>

<script>
  // SDK'nÄ±n yÃ¼klendiÄŸini kontrol eden fonksiyon (promise dÃ¶ner)
  

// Rewarded Popup

show_9441902('pop').then(() => {
    // user watch ad till the end or close it in interstitial format
    // your code to reward user for rewarded format
}).catch(e => {
    // user get error during playing ad
    // do nothing or whatever you want
})
        }
      };
      check();
    });
  }

  const btn = document.getElementById('watchAdBtn');
  const status = document.getElementById('status');

  // Token oluÅŸturma ve localStorage'da saklama
  function getUserToken() {
    let token = localStorage.getItem('userToken');
    if (!token) {
      token = crypto.randomUUID ? crypto.randomUUID() : Math.random().toString(36).slice(2);
      localStorage.setItem('userToken', token);
    }
    return token;
  }

  // Butonu aktif hale getir ve reklam izleme fonksiyonunu ata
  waitForSdkLoaded().then(() => {
    btn.textContent = "ğŸ¥ ReklamÄ± Ä°zle";
    btn.disabled = false;
    status.textContent = "Reklam izlemeye hazÄ±r.";
  }).catch(e => {
    status.textContent = "âŒ Reklam altyapÄ±sÄ± yÃ¼klenemedi. SayfayÄ± yenileyin.";
    console.error(e);
  });

  btn.addEventListener('click', () => {
    btn.disabled = true;
    status.textContent = "Reklam yÃ¼kleniyor...";
    show_9441902().then(() => {
      alert("ğŸ‰ 0.0001 TON kazandÄ±nÄ±z!");
      // Ã–dÃ¼l kaydÄ± backend'e gÃ¶nder
      fetch('/api/reward', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ 
          token: getUserToken(),
          timestamp: Date.now()
        })
      }).then(res => res.json())
        .then(data => {
          if (data.status === 'success') {
            status.textContent = `Bakiyeniz: ${data.balance} TON`;
          } else if (data.status === 'limit_reached') {
            status.textContent = "GÃ¼nlÃ¼k reklam izleme limitine ulaÅŸtÄ±nÄ±z.";
          } else {
            status.textContent = "Sunucu hatasÄ±.";
          }
        }).catch(() => {
          status.textContent = "Sunucuya baÄŸlanÄ±lamadÄ±.";
        }).finally(() => {
          btn.disabled = false;
          btn.textContent = "ğŸ¥ ReklamÄ± Ä°zle";
        });
    }).catch(() => {
      alert("Reklam gÃ¶sterilemedi, lÃ¼tfen tekrar deneyin.");
      status.textContent = "Reklam yÃ¼klenemedi.";
      btn.disabled = false;
      btn.textContent = "ğŸ¥ ReklamÄ± Ä°zle";
    });
  });
</script>
</body>
</html></html>
